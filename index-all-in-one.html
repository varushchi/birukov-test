<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .list-div
        {
            margin-left: 30px;
        }
    </style>
</head>
<body>
    
    <main></main>

    <script>
        
        const data = {
            "services": [
                {
                    "id": 1,
                    "head": null,
                    "name": "Проф.осмотр",
                    "node": 0,
                    "price": 100.0,
                    "sorthead": 20
                },
                {
                    "id": 2,
                    "head": null,
                    "name": "Хирургия",
                    "node": 1,
                    "price": 0.0,
                    "sorthead": 10
                },
                {
                    "id": 3,
                    "head": 2,
                    "name": "Удаление зубов",
                    "node": 1,
                    "price": 0.0,
                    "sorthead": 10
                },
                {
                    "id": 4,
                    "head": 3,
                    "name": "Удаление зуба",
                    "node": 0,
                    "price": 800.0,
                    "sorthead": 10
                },
                {
                    "id": 5,
                    "head": 3,
                    "name": "Удаление 8ого зуба",
                    "node": 0,
                    "price": 1000.0,
                    "sorthead": 30
                },
                {
                    "id": 6,
                    "head": 3,
                    "name": "Удаление осколка зуба",
                    "node": 0,
                    "price": 2000.0,
                    "sorthead": 20
                },
                {
                    "id": 7,
                    "head": 2,
                    "name": "Хирургические вмешательство",
                    "node": 0,
                    "price": 200.0,
                    "sorthead": 10
                },
                {
                    "id": 8,
                    "head": 2,
                    "name": "Имплантация зубов",
                    "node": 1,
                    "price": 0.0,
                    "sorthead": 20
                },
                {
                    "id": 9,
                    "head": 8,
                    "name": "Коронка",
                    "node": 0,
                    "price": 3000.0,
                    "sorthead": 10
                },
                {
                    "id": 10,
                    "head": 8,
                    "name": "Слепок челюсти",
                    "node": 0,
                    "price": 500.0,
                    "sorthead": 20
                }
            ]
        }

        const services = data.services

        const main = document.querySelector('main')
        services.sort((obj1,obj2) => obj1.sorthead - obj2.sorthead)

        for (i = 0; i < services.length; i++)
        {   
            let newDivElem = document.getElementById(services[i].id.toString())

            if (!newDivElem)
            {
                newDivElem = document.createElement("div")
                newDivElem.id = services[i].id
            }

            newDivElem.prepend(`${services[i].name} (${services[i].price})`)

            if (services[i].head === null)
            {
                main.append(newDivElem)
            }

            else
            {
                let findId = services.find(obj => services[i].head === obj.id && services[i].id >= obj.id).id
                
                    let newListDiv = document.getElementById(findId.toString())
                    newDivElem.classList.add('list-div')
                    
                    if(!newListDiv)
                    {
                        let newNodeDiv = document.createElement("div")
                        newNodeDiv.id = findId
                        newNodeDiv.append(newDivElem)
                        main.append(newNodeDiv)
                    }

                    else
                    {
                        newListDiv.append(newDivElem)
                    }
            }
        }
    </script>
</body>
</html>